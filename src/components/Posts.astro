---
import type { FrontmatterPost } from '../types';
import PostCard from './PostCard.astro';

let posts: FrontmatterPost[];

try {
  posts = (await Astro.glob('../posts/**/*.{md,mdx}'))
    .filter((post) => !post.frontmatter.archived)
    .sort(
      (a, b) =>
        new Date(b.frontmatter.pubDate).valueOf() -
        new Date(a.frontmatter.pubDate).valueOf()
    ) as FrontmatterPost[];
} catch {
  posts = [];
}
---

{
  !!posts.length ? (
    <div class="columns-1 md:columns-2 lg:columns-3 mt-12 md:mx-4 lg:mx-18 xl:mx-36">
      {posts.map((post) => (
        <PostCard {...post} />
      ))}
    </div>
  ) : (
    <div class="flex justify-center mt-48 text-center">
      <div>here be dragons</div>
    </div>
  )
}
